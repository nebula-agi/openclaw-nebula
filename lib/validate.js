function f(e){return!e||typeof e!="string"?{valid:!1,reason:"API key is empty or not a string"}:e.length<10?{valid:!1,reason:"API key is too short"}:/\s/.test(e)?{valid:!1,reason:"API key contains whitespace"}:{valid:!0}}function u(e){return!e||typeof e!="string"?{valid:!1,reason:"name is empty"}:e.length>100?{valid:!1,reason:"name exceeds 100 characters"}:/^[a-zA-Z0-9_-]+$/.test(e)?/^[-_]|[-_]$/.test(e)?{valid:!1,reason:"name must not start or end with - or _"}:{valid:!0}:{valid:!1,reason:"name contains invalid characters (only alphanumeric, underscore, hyphen allowed)"}}var o=[/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,/\uFEFF/g,/[\uFFF0-\uFFFF]/g];function c(e,n=1e5){if(!e||typeof e!="string")return"";let t=e;for(let r of o)t=t.replace(r,"");return t.length>n&&(t=t.slice(0,n)),t}function d(e,n=1,t=1e5){return e.length<n?{valid:!1,reason:`content below minimum length (${n})`}:e.length>t?{valid:!1,reason:`content exceeds maximum length (${t})`}:{valid:!0}}var s=50,a=128,l=1024;function g(e){let n={},t=0;for(let[r,i]of Object.entries(e)){if(t>=s)break;r.length>a||/^[\w.-]+$/.test(r)&&(typeof i=="string"?(n[r]=i.slice(0,l),t++):(typeof i=="number"&&Number.isFinite(i)||typeof i=="boolean")&&(n[r]=i,t++))}return n}export{c as sanitizeContent,g as sanitizeMetadata,f as validateApiKeyFormat,u as validateCollectionName,d as validateContentLength};
